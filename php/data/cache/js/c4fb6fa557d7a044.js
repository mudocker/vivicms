var pt=function(){var e={},t={},n="",o=null,r=625,i=400,a="",c="",l=null,s={_counter:0,_uid:function(){return"h"+s._counter++},add:function(e,t,n){if(document.addEventListener)e.addEventListener(t,n,!1);else if(document.attachEvent){if(-1!=s._find(e,t,n))return;var o=function(t){t||(t=window.event);var o={_event:t,type:t.type,target:t.srcElement,currentTarget:e,relatedTarget:t.fromElement?t.fromElement:t.toElement,eventPhase:t.srcElement==e?2:3,clientX:t.clientX,clientY:t.clientY,screenX:t.screenX,screenY:t.screenY,altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,keyCode:t.keyCode,origin:t.origin,data:t.data,stopPropagation:function(){this._event.cancelBubble=!0},preventDefault:function(){this._event.returnValue=!1}};Function.prototype.call?n.call(e,o):(e._currentHandler=n,e._currentHandler(o),e._currentHandler=null)};e.attachEvent("on"+t,o);var r={element:e,eventType:t,handler:n,wrappedHandler:o},i=e.document||e,a=i.parentWindow,c=s._uid();a._allHandlers||(a._allHandlers={}),a._allHandlers[c]=r,e._handlers||(e._handlers=[]),e._handlers.push(c),a._onunloadHandlerRegistered||(a._onunloadHandlerRegistered=!0,a.attachEvent("onunload",s._removeAllHandlers))}},remove:function(e,t,n){if(document.addEventListener)e.removeEventListener(t,n,!1);else if(document.attachEvent){var o=s._find(e,t,n);if(-1==o)return;var r=e.document||e,i=r.parentWindow,a=e._handlers[o],c=i._allHandlers[a];e.detachEvent("on"+t,c.wrappedHandler),e._handlers.splice(o,1),delete i._allHandlers[a]}},_find:function(e,t,n){var o=e._handlers;if(!o)return-1;for(var r=e.document||e,i=r.parentWindow,a=o.length-1;a>=0;a--){var c=o[a],l=i._allHandlers[c];if(l.eventType==t&&l.handler==n)return a}return-1},_removeAllHandlers:function(){var e=this;for(id in e._allHandlers){var t=e._allHandlers[id];t.element.detachEvent("on"+t.eventType,t.wrappedHandler),delete e._allHandlers[id]}},src:function(e){return e?e.target:event.srcElement},stopPropagation:function(e){e?e.stopPropagation():event.cancelBubble=!0}},d=function(e){var t;return function(e){if(!e)return e;for(;e!=unescape(e);)e=unescape(e);for(var t=["<",">","'",'"',"%3c","%3e","%27","%22","%253c","%253e","%2527","%2522"],n=["&#x3c;","&#x3e;","&#x27;","&#x22;","%26%23x3c%3B","%26%23x3e%3B","%26%23x27%3B","%26%23x22%3B","%2526%2523x3c%253B","%2526%2523x3e%253B","%2526%2523x27%253B","%2526%2523x22%253B"],o=0;o<t.length;o++)e=e.replace(new RegExp(t[o],"gi"),n[o]);return e}((t=document.cookie.match(RegExp("(^|;\\s*)"+e+"=([^;]*)(;|$)")))?unescape(t[2]):"")},u=function(e,t,n){document.cookie=e+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; path="+(n||"/")+"; "+(t?"domain="+t+";":"")},p=function(e){(new Image).src=e},f=function(e,t){if(!(Math.random()>(t||1))){var n=location.protocol+"//ui.ptlogin2.qq.com/cgi-bin/report?id="+e+"&v="+Math.random();p(n)}},m=function(t,n){e[t]=n},h=function(t){e=t},v=function(e,n){t[e]=n},g=function(){var t=e.protocol||location.protocol||"http:";t+="//";var o=e.domain||"qq.com";"https:"==e.protocol&&"qq.com"!=o&&"tenpay.com"!=o&&(t="https://ssl."),n=t+"xui.ptlogin2."+o,c=n;var r=n+"/cgi-bin/xlogin?",i="";for(var a in e)"protocol"!=a&&"domain"!=a&&(i+=a+"="+encodeURIComponent(e[a])+"&");return r+=i},_=function(t,n){if(n)o=n;else{o=document.createElement("div"),document.body.appendChild(o);var r="left:50%;";r+="top:50%;",r+="position:fixed;",r+="z-index:9999;",r+="background:none;",r+="_position:absolute;",r+="_top:expression(eval(document.documentElement.scrollTop+(document.documentElement.clientHeight-this.offsetHeight)/2));",r+="_margin-top:0px;";var i=parseInt(e.height);isNaN(i)||(r+="height:"+i+"px;");var a=parseInt(e.width);isNaN(a)||(r+="width:"+a+"px;"),o.style.cssText=r}o.innerHTML='<iframe name="ui_ptlogin" id="ui_ptlogin" allowtransparency="true" scrolling="no" frameborder="0" width="100%" height="100%" style="top:0; left:0;'+(1==e.border_radius?"border-radius:5px;":"")+'" src="'+t+'">'},y=function(e){var t=g();a?document.getElementById("ui_ptlogin").src=t:(_(t,e),-[1]||window.XMLHttpRequest||k(r-1,i-1)),a=t,x(),o.style.display="block"},w=function(){o.style.display="none",E()},x=function(){var t=e.maskOpacity;if(0!=t){if(!l){var n="background-color:#000;overflow:hidden;position:fixed;left:0;top:0;width:100%;height:100%;z-index:9998;opacity:"+t/100+";filter:alpha(opacity="+t+");";n+="_position:absolute;_height:expression(eval(document.documentElement.scrollTop+document.documentElement.clientHeight));_width:expression(eval(document.documentElement.scrollLeft+document.documentElement.clientWidth));",l=document.createElement("div"),l.style.cssText=n,document.body.appendChild(l)}l.style.display="block"}},E=function(){l&&(l.style.display="none")},k=function(e,n){var a=o;a&&e>1&&n>1&&(r!=e||i!=n)&&("function"==typeof t.resize?t.resize(parseInt(e),parseInt(n)):(a.style.width=e+"px",a.style.height=n+"px",a.style.marginLeft=-e/2+"px",a.style.marginTop=-n/2+"px")),r=e,i=n},H=function(){w(),"function"==typeof t.close&&t.close()},b=function(e){var t={};if("undefined"!=typeof JSON)t=JSON.parse(e);else{var n=/^[\],:{}\s]*$/,o=/(?:^|:|,)(?:\s*\[)+/g,r=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,i=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g;n.test(e.replace(r,"@").replace(i,"]").replace(o,""))&&(t=new Function("return "+e)())}return t},T=function(){void 0!==window.postMessage?s.add(window,"message",function(e){if(e.origin.replace(/^https?:/,"")==c.replace(/^https?:/,"")){var t=b(e.data);switch(t.action){case"close":H();break;case"resize":k(t.width,t.height)}}}):navigator.ptlogin_callback=function(e){var t=b(e);switch(t.action){case"close":H();break;case"resize":k(t.width,t.height)}}},q="",B="",z=function(){B=location.hostname.match(/\w*\.(cc|com|cn|com\.cn|game)$/),B=B?B[0]:"",q=location.hostname.match(/\w+(\.\w+)\.(cc|com|cn|com\.cn|game)$/),q=q?q[0]:"","qq.com"!=B&&(q=B)},C=function(e){var t=d("pt4_token"),n=d("skey"),o=L(n),r=d("ptcz"),i=L(r),a=e?"qq.com":B,c=("https:"==location.protocol?"https://ssl.":"http://")+"ptlogin2."+a+"/logout?";return c+="pt4_token="+t+"&pt4_hkey="+o+"&pt4_ptcz="+i+"&deep_logout=1"},L=function(e){for(var t=0,n=0,o=e.length;n<o;++n)t+=(t<<5)+e.charCodeAt(n);return 2147483647&t},P=function(){u("uin",B),u("skey",B),u("p_uin",q),u("p_skey",q),u("p_luin",q),u("p_lskey",q),u("pt4_token",q),u("pt_mbkey",B),""!=q&&""!=d("skey_m")&&(u("uin_m",q),u("skey_m",q))},I=function(e,t){z();var n=d("pt4_token"),o=d("skey"),r=d("ptcz"),i=C(t);(n||o||r)&&p(i),window.setTimeout(function(){P(),e&&e(2)},100)},M=function(e){I(e,!0)};return function(){T(),window.setTimeout(function(){f(447926,1)},1e3)}(),{showPtui:y,hidePtui:w,setParam:m,setParams:h,setCallback:v,logout:I,logoutQQCom:M}}();